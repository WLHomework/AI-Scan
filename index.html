<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>智能摄像</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <script async src="lib/opencv.js" onload="onOpenCvReady();" onerror="onOpenCvError();"></script>
    <script src="node_modules/@panzoom/panzoom/dist/panzoom.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- 标题栏 -->
        <div class="title-bar">
            <div class="app-title">相机</div>
            <div class="window-controls">
                <button class="minimize-btn">—</button>
                <button class="close-btn">×</button>
            </div>
        </div>

        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 侧边栏 -->
            <div class="sidebar">
                <button id="settings-button" class="sidebar-btn settings-btn" title="设置">
                    <span class="material-symbols-outlined">settings</span>
                </button>
            </div>

            <!-- 预览区域 -->
            <div class="preview-area">
                <video id="preview" autoplay></video>
                <canvas id="photo-canvas" style="display: none;"></canvas>
                <canvas id="processed-preview" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></canvas>
                
                <!-- 预览区域覆盖层 -->
                <div class="preview-overlay">
                    <!-- 左侧工具栏 -->
                    <div class="toolbar left-toolbar">
                        <button class="toolbar-btn timer-btn" title="计时器">
                            <span class="material-symbols-outlined">timer</span>
                        </button>
                        <button class="toolbar-btn grid-btn" title="网格线">
                            <span class="material-symbols-outlined">grid_on</span>
                        </button>
                        <button id="toggle-processing-btn" class="toolbar-btn" title="切换图像处理">
                            <span class="material-symbols-outlined">auto_fix_high</span>
                        </button>
                    </div>
                    
                    <!-- 右侧工具栏 -->
                    <div class="toolbar right-toolbar">
                        <button id="switch-camera" class="toolbar-btn" title="切换相机">
                            <span class="material-symbols-outlined">flip_camera_android</span>
                        </button>
                        <button id="rotate-btn" class="toolbar-btn" title="旋转画面">
                            <span class="material-symbols-outlined">rotate_90_degrees_cw</span>
                        </button>
                    </div>
                    
                    <!-- 底部控制区 -->
                    <div class="bottom-controls">
                        <div class="mode-switch">
                            <button class="mode-btn active" data-mode="photo" title="照片模式">
                                <span class="material-symbols-outlined">photo_camera</span>
                            </button>
                            <button class="mode-btn" data-mode="video" title="视频模式">
                                <span class="material-symbols-outlined">videocam</span>
                            </button>
                            <button class="mode-btn" data-mode="scan" title="扫描模式">
                                <span class="material-symbols-outlined">document_scanner</span>
                            </button>
                        </div>
                        
                        <div class="capture-area">
                            <button class="gallery-btn" title="媒体库">
                                <div class="thumbnail"></div>
                            </button>
                            
                            <button id="capture-btn" class="capture-btn">
                                <div class="capture-btn-inner"></div>
                            </button>
                            
                            <div class="spacer"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 先加载图像处理器，再加载主应用 -->
    <script src="js/image-processor.js"></script>
    <script src="js/app.js"></script>
</body>
</html> 